title = "experiences"
url = "/experiencias/:days/:interest/:tvisit"
layout = "dinamic"
is_hidden = 0

[staticApp]

==
<?php  
	
	function onStart()
	{	    
    
    if (strpos($_SERVER['HTTP_HOST'], 'localhost') !== false) {
          $this['preurl'] = '/cadizturismo';
    } else {
        $this['preurl'] = '';
    }

    $this['lang']=\App::getLocale();
		if($this['lang']==''){
			$this['lang']='es';
		}
    
    $days = $this->param('days');
    if($days == 'dejate-llevar'){
      $days = 'all';
    }
    
    $interest = $this->getStringSlugInterest($this->param('interest'));
    $tvisit = $this->getStringSlugTvisit($this->param('tvisit'));

    $experiences = $this->staticApp->experienceFind($days,$interest,$tvisit);
    $this['experiences'] = $experiences;
    
    $this['ptitle'] = 'Cádiz | Experiencias';
    $this['metaTitle'] = 'Cádiz | Experiencias';

	}

  function getStringSlugInterest($value){

    switch ($value) {
      case 'playa-gastronomia':
        $interest = 'playa y gastronomía';
        break;
      case 'cultura-gastronomia':
        $interest = 'cultura y gastronomía';
        break;
      case 'fiesta-cultura':
        $interest = 'fiesta y cultura';
        break;
      case 'gastronomia-naturaleza':
        $interest = 'gastronomía y naturaleza';
        break;
      case 'naturaleza-aventura':
        $interest = 'naturaleza y aventura';
        break;
      case 'playa-naturaleza':
        $interest = 'playa y naturaleza';
        break;
      case 'vino-tradicion':
        $interest = 'vino y tradición';
        break;
      case 'aventura-tradicion':
        $interest = 'aventura y tradición';
        break;
      
      default:
        $interest = 'all';
        break;
    }

    return $interest;

  } 

  function getStringSlugTvisit($value){

    switch ($value) {
      case 'cadiz-oculta':
        $interest = 'cádiz oculta';
        break;
      case 'cadiz-autentica':
        $interest = 'cádiz auténtica';
        break;
      case 'cadiz-relax':
        $interest = 'cádiz relax';
        break;
      case 'cadiz-urbano':
        $interest = 'cádiz urbano';
        break;
      
      default:
        $interest = 'all';
        break;
    }

    return $interest;

  } 
       

	function onFindExperience(){

		$days = $_POST['days'];
		$interest = $_POST['interest'];
		$tvisit = $_POST['tvisit'];
    	
    	$experiences = $this->staticApp->experienceFind($days,$interest,$tvisit);
    	Session::put('data',json_encode($experiences));

    	$this['experiences'] = $experiences;
    
    	return [
    		'#prtlExperiences' => $this->renderPartial('experiences')
    	];
 
  }

?>
==

<!-- HEADER -->
<div class="header-search search-exp">
  
  <div class="header-container big-div">
    <div id="exp-header" class="header-txt">
      <p class="txt"><span id="exp" class="first-word">{{'Experiencias'|_}}</span> {{'pensadas para ti'|_}}</p>
        <img class="brush" src="{{preurl}}/storage/app/media/uploaded-files/templates/brush-header.svg" alt="">
    </div>
   
    <!-- SEARCH -->
    <div id='prtlSearchExperiences'>
      {% partial "site/search" %}
    </div>

  </div>
</div>

<div id='prtlExperiences' class="all-exps">
	{% partial "experiences" %}
</div>